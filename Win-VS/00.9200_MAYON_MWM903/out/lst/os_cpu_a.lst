


ARM Macro Assembler    Page 1 


    1 00000000         ;*******************************************************
                       *************************************************
    2 00000000         ;                                               uC/OS-II
                       
    3 00000000         ;                                         The Real-Time 
                       Kernel
    4 00000000         ;
    5 00000000         ;                          (c) Copyright 1992-2002, Jean
                        J. Labrosse, Weston, FL
    6 00000000         ;                                          All Rights Re
                       served
    7 00000000         ;
    8 00000000         ; File : OS_CPU_A.ASM
    9 00000000         ; By   : Jean J. Labrosse
   10 00000000         ;*******************************************************
                       *************************************************
   11 00000000         
   12 00000000         ;*******************************************************
                       *************************************************
   13 00000000         ;                                               ARM Port
                       
   14 00000000         ;
   15 00000000         ;                 Target           : ARM (Includes ARM7,
                        ARM9)
   16 00000000         ;                 Ported by        : Michael Anburaj
   17 00000000         ;                 URL              : http://geocities.co
                       m/michaelanburaj/    Email : michaelanburaj@hotmail.com
   18 00000000         ;
   19 00000000         ;*******************************************************
                       *************************************************
   20 00000000         
   21 00000000                 PRESERVE8                    ; current file pres
                                                            erves eight-byte al
                                                            ignment of the stac
                                                            k
   22 00000000         
   23 00000000                 INCLUDE          ..\..\inc\sysopt.inc
    1 00000000         ;
    2 00000000         ;Copyright (c) 2008 Mars Semiconductor Corp.
    3 00000000         ;
    4 00000000         ;Module Name:
    5 00000000         ;
    6 00000000         ; sysopt.inc
    7 00000000         ;
    8 00000000         ;Abstract:
    9 00000000         ;
   10 00000000         ;    The system option.
   11 00000000         ;
   12 00000000         ;Environment:
   13 00000000         ;
   14 00000000         ;    ARM RealView Developer Suite
   15 00000000         ;
   16 00000000         ;Revision History:
   17 00000000         ; 
   18 00000000         ; 2011/11/10 Lucian Yuan Create 
   19 00000000         ;
   20 00000000         
   21 00000000         
   22 00000000                 INCLUDE          .\sysoptdef.inc



ARM Macro Assembler    Page 2 


    1 00000000         ;
    2 00000000         ;Copyright (c) 2008 Mars Semiconductor Corp.
    3 00000000         ;
    4 00000000         ;Module Name:
    5 00000000         ;
    6 00000000         ; sysopt.inc
    7 00000000         ;
    8 00000000         ;Abstract:
    9 00000000         ;
   10 00000000         ;    The system option.
   11 00000000         ;
   12 00000000         ;Environment:
   13 00000000         ;
   14 00000000         ;    ARM RealView Developer Suite
   15 00000000         ;
   16 00000000         ;Revision History:
   17 00000000         ; 
   18 00000000         ; 2006/07/18 David Tsai Create 
   19 00000000         ;
   20 00000000         
   21 00000000         ;CY 0907
   22 00000000         
   23 00000000         ;
   24 00000000         ; BOOT_SRC_OPT
   25 00000000         ; 0 - From RAM.
   26 00000000         ; 1 - From ROM.
   27 00000000         ; 2 - From MASKROM.
   28 00000000         ;
   29 00000000                 GBLA             BOOT_SRC_RAM
   30 00000000                 GBLA             BOOT_SRC_ROM
   31 00000000                 GBLA             BOOT_SRC_MASKROM
   32 00000000 00000000 
                       BOOT_SRC_RAM
                               SETA             0
   33 00000000 00000001 
                       BOOT_SRC_ROM
                               SETA             1
   34 00000000 00000002 
                       BOOT_SRC_MASKROM
                               SETA             2
   35 00000000         
   36 00000000         
   37 00000000         ; Twokey 061214
   38 00000000         ;
   39 00000000         ;
   40 00000000         ;CODE_DEVICE_OPT
   41 00000000 00000009 
                       CODE_STR_ROMTER
                               EQU              0x00000009
   42 00000000 00000009 
                       CODE_STR_EEPROM
                               EQU              0x00000009
   43 00000000 00000001 
                       CODE_STR_RAM
                               EQU              0x00000001
   44 00000000         
   45 00000000         ;
   46 00000000         ; CLK_SRC_OPT
   47 00000000         ; 0x00 - CLK_SRC_XIN.



ARM Macro Assembler    Page 3 


   48 00000000         ; 0x40 - CLK_SRC_PLLOUT_PA9001D_48M.
   49 00000000         ; 0x41 - CLK_SRC_PLLOUT_PA9001C_64_8M.
   50 00000000         ; 0x42 - CLK_SRC_PLLOUT_PA9001C_162M.
   51 00000000         ; 0x43 - CLK_SRC_PLLOUT_PA9001C_216M.
   52 00000000         ;
   53 00000000 00000000 
                       CLK_SRC_XIN
                               EQU              0x00
   54 00000000 00000000 
                       CLK_SRC_PLLOUT_PA9001D_48M
                               EQU              0x00
   55 00000000 00000001 
                       CLK_SRC_PLLOUT_PA9001C_64_8M
                               EQU              0x01
   56 00000000 00000002 
                       CLK_SRC_PLLOUT_PA9001C_162M
                               EQU              0x02
   57 00000000 00000003 
                       CLK_SRC_PLLOUT_PA9001C_216M
                               EQU              0x03
   58 00000000         
   59 00000000 3F680000 
                       CLK_SRC_PLLOUT_PA9002D_48M
                               EQU              0x3F680000
   60 00000000 3F480000 
                       CLK_SRC_PLLOUT_PA9002D_192M
                               EQU              0x3F480000
   61 00000000         
   62 00000000 3F680000 
                       CLK_SRC_PLLOUT_PA9003A_48M
                               EQU              0x3F680000
   63 00000000 3F181000 
                       CLK_SRC_PLLOUT_PA9003A_96M
                               EQU              0x3F181000
   64 00000000 00000000 
                       CLK_SRC_PLLOUT_PA9003A_FPGA
                               EQU              0x00
   65 00000000         
   66 00000000         ;CY 1023
   67 00000000         
   68 00000000         ;
   69 00000000         ; CHIP_OPT
   70 00000000         ;     0x00 - PA9001A.
   71 00000000         ;     0x01 - PA9001C.
   72 00000000         ;     0x02 - PA9002A.
   73 00000000         ;       0x03 - PA9001D
   74 00000000         ;       0x04 - PA9002C
   75 00000000         ;       0x05 - PA9002B on FPGA
   76 00000000         ;       0x06 - PA9002D
   77 00000000         
   78 00000000         
   79 00000000         ;----CPU: K310----//
   80 00000000 00000000 
                       CHIP_OPT_PA9001A
                               EQU              0x00
   81 00000000 00000001 
                       CHIP_OPT_PA9001C
                               EQU              0x01
   82 00000000 00000002 



ARM Macro Assembler    Page 4 


                       CHIP_OPT_PA9002A
                               EQU              0x02
   83 00000000 00000003 
                       CHIP_OPT_PA9001D
                               EQU              0x03
   84 00000000 00000004 
                       CHIP_OPT_PA9002C
                               EQU              0x04
   85 00000000 00000005 
                       FPGA_OPT_PA9002B
                               EQU              0x05
   86 00000000 00000006 
                       CHIP_OPT_PA9002D
                               EQU              0x06
   87 00000000         
   88 00000000 00000007 
                       CHIP_OPT_A1016A
                               EQU              0x07        ;ASIC
   89 00000000 00000008 
                       CHIP_OPT_A1016A_FPGA
                               EQU              0x08        ;FPGA
   90 00000000         
   91 00000000 00000009 
                       CHIP_OPT_A1018A
                               EQU              0x09        ;ASIC
   92 00000000 0000000A 
                       CHIP_OPT_A1018A_FPGA
                               EQU              0x0a        ;FPGA
   93 00000000         
   94 00000000         ;---CPU: ARM926EJ-----//
   95 00000000 00000010 
                       CHIP_OPT_A1013A
                               EQU              0x10        ;ASIC
   96 00000000 00000011 
                       CHIP_OPT_A1013A_FPGA
                               EQU              0x11        ;FPGA
   97 00000000         
   98 00000000 00000012 
                       CHIP_OPT_A1013B
                               EQU              0x12        ;ASIC
   99 00000000 00000013 
                       CHIP_OPT_A1013B_FPGA
                               EQU              0x13        ;FPGA
  100 00000000         
  101 00000000 00000014 
                       CHIP_OPT_A1019A
                               EQU              0x14        ;ASIC ARM926
  102 00000000 00000015 
                       CHIP_OPT_A1020A
                               EQU              0x15        ;ASIC
  103 00000000 00000016 
                       CHIP_OPT_A1021A
                               EQU              0x16        ;ASIC
  104 00000000 00000017 
                       CHIP_OPT_A1022A
                               EQU              0x17        ;ASIC
  105 00000000                 END                          ; mark the end of t
                                                            his file
   23 00000000         



ARM Macro Assembler    Page 5 


   24 00000000         ;------------¿ï¾ÜBOOT source: RAM(via ICE/boot-loader), 
                       ROM(EEPROM/NOR/ROMTER)------------------
   25 00000000         ; BOOT_SRC_OPT
   26 00000000         ; BOOT_SRC_RAM - From RAM. 
   27 00000000         ; BOOT_SRC_ROM - From ROM.
   28 00000000         ; BOOT_SRC_MASKROM - From MASK ROM.
   29 00000000         ;
   30 00000000         
   31 00000000                 GBLA             BOOT_SRC_OPT
   32 00000000 00000000 
                       BOOT_SRC_OPT
                               SETA             BOOT_SRC_RAM
   33 00000000         
   34 00000000         
   35 00000000         ;---------------³]©w Static RAM timing--------------
   36 00000000         ;CODE_DEVICE_OPT
   37 00000000         ;CODE_STR_ROMTER  - Program code is stored in Romter
   38 00000000         ;CODE_STR_EEPROM  - Program code is stored in EEPROM
   39 00000000         ;CODE_STR_RAM     - Program code is stored in RAM
   40 00000000         ;
   41 00000000         
   42 00000000 00000001 
                       CODE_DEVICE_OPT
                               EQU              CODE_STR_RAM
   43 00000000         
   44 00000000         ;-----------------IC ª©¥»¿ï¾Ü: 9001D ­n¥´¶}Cache,¨ä¥L«h§
                       _----------------------
   45 00000000         ; CHIP_OPT
   46 00000000         ; CHIP_OPT_PA9001D     - PA9001D.
   47 00000000         ; CHIP_OPT_PA9002C     - PA9002C.
   48 00000000         ;   FPGA_OPT_PA9002B     - FPGA_9002B
   49 00000000         ; CHIP_OPT_PA9002D     - PA9002D.
   50 00000000         
   51 00000000         ; CHIP_OPT_A1013A      - PA9003A.
   52 00000000         ;   CHIP_OPT_A1013A_FPGA - FPGA_PA9003A
   53 00000000         
   54 00000000         ; CHIP_OPT_A1013B      - PA9003B.
   55 00000000         ;   CHIP_OPT_A1013B_FPGA - FPGA_PA9003B
   56 00000000         
   57 00000000         ;   CHIP_OPT_A1016A      - A1016
   58 00000000         ;   CHIP_OPT_A1016A_FPGA - A1016FPGA
   59 00000000         
   60 00000000                 GBLA             CHIP_OPT
   61 00000000 00000007 
                       CHIP_OPT
                               SETA             CHIP_OPT_A1016A
   62 00000000         
   63 00000000         ;------------------PLL clock output selection-----------
                       ---------
   64 00000000         ; CLK_SRC_OPT
   65 00000000         
   66 00000000         ;   CLK_SRC_PLLOUT_PA9001D_48M - From PLL out 48MHz.
   67 00000000         ;   CLK_SRC_PLLOUT_PA9001C_64_8M - From PLL out 64.8MHz.
                       
   68 00000000         ;   CLK_SRC_PLLOUT_PA9001C_162M - From PLL out 162MHz.
   69 00000000         ;   CLK_SRC_PLLOUT_PA9001C_216M - From PLL out 216MHz.
   70 00000000         
   71 00000000         ;   CLK_SRC_PLLOUT_PA9002D_192M - From PLL out 192MHz
   72 00000000         ;   CLK_SRC_PLLOUT_PA9003A_FPGA - For FPGA test



ARM Macro Assembler    Page 6 


   73 00000000         
   74 00000000         ;CLK_SRC_OPT EQU  CLK_SRC_XIN ; for FPGA
   75 00000000         
   76 00000000 00000000 
                       CLK_SRC_OPT
                               EQU              CLK_SRC_PLLOUT_PA9003A_FPGA
   77 00000000         
   78 00000000         
   79 00000000         ;-----------------¿ï¾ÜDRAM Clock ¤Ï¬Û®É¶¡ÂI-------------
                       ----
   80 00000000         ;¥Î©óPA9002D
   81 00000000         ;¥Ñ©ó§Ú­ÌªºDRAM Timing ¤ñ¸ûsensitive. ·|¸òÁû²É»PLayout ¦
                       ³Ãö. ­YµLªk¶}¾÷½Ð½Õ¾ã.
   82 00000000         ; ¥Ø«e¤wª¾ SUNWAY ¥²¶·³]©w¬° 0
   83 00000000         ; ¨ä¥L Project ¬° 1 
   84 00000000         
   85 00000000 00000000 
                       DRAM_CLK_INV_FIRST
                               EQU              0
   86 00000000         
   87 00000000         
   88 00000000         ;------------------±ÀºâPLL clock -----------------
   89 00000000         ; CLK_SRC_FREQ
   90 00000000         ; Clock source frequency
   91 00000000         ;
   92 00000000 01E84800 
                       CLK_SRC_FREQ
                               EQU              32000000    ; 32/48M
   93 00000000         
   94 00000000         ;------³]©w Sensor MCLK -------
   95 00000000         ; CLK_MCK_DIV 
   96 00000000         ; Sensor Master ClocK divisor
   97 00000000         ;
   98 00000000 00000002 
                       CLK_MCK_DIV
                               EQU              0x02        ; 32/2=16M
   99 00000000         
  100 00000000         ;------³]©w IDU clock -----
  101 00000000         ; CLK_IDU_DIV
  102 00000000         ; Image Display Unit clock divisor
  103 00000000         ;
  104 00000000 00000001 
                       CLK_IDU_DIV
                               EQU              0x01        ; 32M / 1 = 32M
  105 00000000         ;------³]©w Watch dog clock ------
  106 00000000         ; CLK_WDT_DIV
  107 00000000         ; Watch Dog Timer clock divisor
  108 00000000         ;
  109 00000000 00000200 
                       CLK_WDT_DIV
                               EQU              0x0200      ; 32M /512 = 62.5K
  110 00000000         
  111 00000000         
  112 00000000         ;------³]©w ADC clock----
  113 00000000         ; CLK_ADC_DIV
  114 00000000         ; Analog-to-Digital Converter clock divisor
  115 00000000         ;
  116 00000000 00000001 
                       CLK_ADC_DIV



ARM Macro Assembler    Page 7 


                               EQU              0x01        ; 32M / 1 = 32M
  117 00000000         
  118 00000000         ;------JPEG VLC clock
  119 00000000         ;JPEG_VLC_DIV
  120 00000000 00000002 
                       CLK_JPEG_VLC_DIV
                               EQU              0x02        ; 32M/2=16M
  121 00000000         
  122 00000000         
  123 00000000                 END
   24 00000000         
   25 00000000         ;Pre-defined constants
   26 00000000 00000010 
                       USERMODE
                               EQU              0x10
   27 00000000 00000011 
                       FIQMODE EQU              0x11
   28 00000000 00000012 
                       IRQMODE EQU              0x12
   29 00000000 00000013 
                       SVCMODE EQU              0x13
   30 00000000 00000017 
                       ABORTMODE
                               EQU              0x17
   31 00000000 0000001B 
                       UNDEFMODE
                               EQU              0x1b
   32 00000000 0000001F 
                       MODEMASK
                               EQU              0x1f
   33 00000000 000000C0 
                       NOINT   EQU              0xc0
   34 00000000 00000020 
                       TBIT    EQU              0x20
   35 00000000         
   36 00000000         ; Fix K310 IRQ/FIQ bug
   37 00000000 D0000000 
                       RegCtrlBase
                               EQU              0xd0000000
   38 00000000 D0000004 
                       RegFiqMask
                               EQU              0xd0000004
   39 00000000 D0000010 
                       RegIrqMask
                               EQU              0xd0000010
   40 00000000 D0000014 
                       RegIntMask
                               EQU              0xd0000014
   41 00000000 C0040038 
                       SdramTimeCtrl
                               EQU              0xc0040038
   42 00000000         
   43 00000000                 IF               (CHIP_OPT < CHIP_OPT_A1016A)
   46                          ENDIF
   47 00000000         
   48 00000000                 IF               ((CHIP_OPT == CHIP_OPT_A1013A) 
|| (CHIP_OPT == CHIP_OPT_A1013A_FPGA))
   51                          ENDIF
   52 00000000         



ARM Macro Assembler    Page 8 


   53 00000000                 IF               ((CHIP_OPT == CHIP_OPT_A1013B) 
|| (CHIP_OPT == CHIP_OPT_A1013B_FPGA) || (CHIP_OPT == CHIP_OPT_A1016A) || (CHIP
_OPT == CHIP_OPT_A1016A_FPGA) || (CHIP_OPT == CHIP_OPT_A1018A) || (CHIP_OPT == 
CHIP_OPT_A1018A_FPGA) || (CHIP_OPT == CHIP_OPT_A1019A))
   54 00000000 00000002 
                       FIXK310BUG
                               EQU              0x00000002
   55 00000000 00000001 
                       SPEEDUPIRQFIQ
                               EQU              0x00000001
   56 00000000                 ENDIF
   57 00000000                 IF               ((CHIP_OPT == CHIP_OPT_A1020A) 
|| (CHIP_OPT == CHIP_OPT_A1021A) || (CHIP_OPT == CHIP_OPT_A1022A))
   60                          ENDIF
   61 00000000         
   62 00000000                 AREA             UCOS_ARM, CODE, READONLY
   63 00000000         
   64 00000000         ;*******************************************************
                       **************************************************
   65 00000000         ;                                          START MULTITA
                       SKING
   66 00000000         ;                                       void OSStartHigh
                       Rdy(void)
   67 00000000         ;
   68 00000000         ; Note : OSStartHighRdy() MUST:
   69 00000000         ;           a) Call OSTaskSwHook() then,
   70 00000000         ;           b) Set OSRunning to TRUE,
   71 00000000         ;           c) Switch to the highest priority task.
   72 00000000         ;*******************************************************
                       **************************************************
   73 00000000         
   74 00000000                 IMPORT           OSTaskSwHook
   75 00000000                 IMPORT           OSRunning
   76 00000000                 IMPORT           OSTCBHighRdy
   77 00000000         
   78 00000000                 EXPORT           OSStartHighRdy
   79 00000000         
   80 00000000         OSStartHighRdy
   81 00000000         
   82 00000000 EBFFFFFE        bl               OSTaskSwHook ; Call user define
                                                            d task switch hook
   83 00000004         
   84 00000004 E59F43D4        ldr              r4,=OSRunning ; Indicate that m
                                                            ultitasking has sta
                                                            rted
   85 00000008 E3A05001        mov              r5,#1
   86 0000000C E5C45000        strb             r5,[r4]
   87 00000010         
   88 00000010 E59F43CC        ldr              r4,=OSTCBHighRdy ; Get highest 
                                                            priority task TCB a
                                                            ddress
   89 00000014         
   90 00000014 E5944000        ldr              r4,[r4]     ; get stack pointer
                                                            
   91 00000018 E594D000        ldr              sp,[r4]     ; switch to the new
                                                             stack
   92 0000001C         
   93 0000001C E8BD0010        ldmfd            sp!,{r4}    ; pop new task's sp
                                                            sr



ARM Macro Assembler    Page 9 


   94 00000020 E8BD0010        ldmfd            sp!,{r4}    ; pop new task's ps
                                                            r
   95 00000024 E16FF004        msr              SPSR_cxsf,r4
   96 00000028 E8FDDFFF        ldmfd            sp!,{r0-r12,lr,pc}^ ; pop new t
                                                            ask's r0-r12,lr & p
                                                            c
   97 0000002C         
   98 0000002C         ;*******************************************************
                       **************************************************
   99 0000002C         ;                                PERFORM A CONTEXT SWITC
                       H (From task level)
  100 0000002C         ;                                           void OSCtxSw
                       (void)
  101 0000002C         ;
  102 0000002C         ; Note(s):    Upon entry, 
  103 0000002C         ;             OSTCBCur     points to the OS_TCB of the t
                       ask to suspend
  104 0000002C         ;             OSTCBHighRdy points to the OS_TCB of the t
                       ask to resume
  105 0000002C         ;
  106 0000002C         ;*******************************************************
                       **************************************************
  107 0000002C         
  108 0000002C                 IMPORT           OSTCBCur
  109 0000002C                 IMPORT           OSTaskSwHook
  110 0000002C                 IMPORT           OSTCBHighRdy
  111 0000002C                 IMPORT           OSPrioCur
  112 0000002C                 IMPORT           OSPrioHighRdy
  113 0000002C         
  114 0000002C                 EXPORT           OSCtxSw
  115 0000002C         
  116 0000002C         OSCtxSw
  117 0000002C         ; Special optimised code below:
  118 0000002C E92D4000        stmfd            sp!,{lr}    ; push pc (lr shoul
                                                            d be pushed in plac
                                                            e of PC)
  119 00000030 E59FE3B0        ldr              lr,=0xdead1eaf ; Just a dummy v
                                                            alue is pushed for 
                                                            lr (for actual lr i
                                                            s safe inside calle
                                                            rs stack)
  120 00000034 E92D5FFF        stmfd            sp!,{r0-r12,lr} ; push lr & reg
                                                            ister file
  121 00000038 E10F4000        mrs              r4,cpsr
  122 0000003C         ;    [ THUMB_TASKS
  123 0000003C         ;        orr r4,r4,#TBIT
  124 0000003C         ;    ]
  125 0000003C E92D0010        stmfd            sp!,{r4}    ; push current psr
  126 00000040 E14F4000        mrs              r4,spsr
  127 00000044 E92D0010        stmfd            sp!,{r4}    ; push current spsr
                                                            
  128 00000048         
  129 00000048         ; OSPrioCur = OSPrioHighRdy
  130 00000048 E59F439C        ldr              r4,=OSPrioCur
  131 0000004C E59F539C        ldr              r5,=OSPrioHighRdy
  132 00000050 E5D56000        ldrb             r6,[r5]
  133 00000054 E5C46000        strb             r6,[r4]
  134 00000058         
  135 00000058         ; Get current task TCB address



ARM Macro Assembler    Page 10 


  136 00000058 E59F4394        ldr              r4,=OSTCBCur
  137 0000005C E5945000        ldr              r5,[r4]
  138 00000060 E585D000        str              sp,[r5]     ; store sp in preem
                                                            pted tasks's TCB
  139 00000064         
  140 00000064 EBFFFFFE        bl               OSTaskSwHook ; call Task Switch
                                                             Hook
  141 00000068         
  142 00000068         ; Get highest priority task TCB address
  143 00000068 E59F6374        ldr              r6,=OSTCBHighRdy
  144 0000006C E5966000        ldr              r6,[r6]
  145 00000070 E596D000        ldr              sp,[r6]     ; get new task's st
                                                            ack pointer
  146 00000074         
  147 00000074         ; OSTCBCur = OSTCBHighRdy
  148 00000074 E5846000        str              r6,[r4]     ; set new current t
                                                            ask TCB address
  149 00000078         
  150 00000078 E8BD0010        ldmfd            sp!,{r4}    ; pop new task's sp
                                                            sr
  151 0000007C E8BD0010        ldmfd            sp!,{r4}    ; pop new task's ps
                                                            r
  152 00000080 E16FF004        msr              SPSR_cxsf,r4
  153 00000084         
  154 00000084 E8FDDFFF        ldmfd            sp!,{r0-r12,lr,pc}^ ; pop new t
                                                            ask's r0-r12,lr & p
                                                            c
  155 00000088         
  156 00000088         
  157 00000088         ;*******************************************************
                       **************************************************
  158 00000088         ;                                PERFORM A CONTEXT SWITC
                       H (From an ISR)
  159 00000088         ;                                        void OSIntIRQCt
                       xSw(void)
  160 00000088         ;
  161 00000088         ; Note(s): This function only flags a context switch to 
                       the ISR Handler
  162 00000088         ;
  163 00000088         ;*******************************************************
                       **************************************************
  164 00000088         
  165 00000088                 IMPORT           OSIntIRQCtxSwFlag
  166 00000088         
  167 00000088                 EXPORT           OSIntIRQCtxSw
  168 00000088         
  169 00000088         OSIntIRQCtxSw
  170 00000088         
  171 00000088         ;OSIntIRQCtxSwFlag = True
  172 00000088 E59F0368        ldr              r0,=OSIntIRQCtxSwFlag
  173 0000008C E3A01001        mov              r1,#1
  174 00000090 E5801000        str              r1,[r0]
  175 00000094 E12FFF1E        bx               lr
  176 00000098         
  177 00000098         ;*******************************************************
                       **************************************************
  178 00000098         ;                                PERFORM A CONTEXT SWITC
                       H (From an ISR)
  179 00000098         ;                                        void OSIntFIQCt



ARM Macro Assembler    Page 11 


                       xSw(void)
  180 00000098         ;
  181 00000098         ; Note(s): This function only flags a context switch to 
                       the ISR Handler
  182 00000098         ;
  183 00000098         ;*******************************************************
                       **************************************************
  184 00000098         
  185 00000098                 EXPORT           OSIntFIQCtxSw
  186 00000098         
  187 00000098                 IMPORT           OSIntFIQCtxSwFlag
  188 00000098         
  189 00000098         OSIntFIQCtxSw
  190 00000098         
  191 00000098         ;OSIntFIQCtxSwFlag = True
  192 00000098 E59F035C        ldr              r0,=OSIntFIQCtxSwFlag
  193 0000009C E3A01001        mov              r1,#1
  194 000000A0 E5801000        str              r1,[r0]
  195 000000A4 E12FFF1E        bx               lr
  196 000000A8         
  197 000000A8         ;*******************************************************
                       **************************************************
  198 000000A8         ;                                CHECK IF AN FIQ INTERRU
                       PT AN IRQ (From an ISR)
  199 000000A8         ;                                        void OSIntFIQNe
                       stIRQ(void)
  200 000000A8         ;
  201 000000A8         ; Note(s): This function only flags an event of fiq inte
                       rrupt irq
  202 000000A8         ;
  203 000000A8         ;*******************************************************
                       **************************************************
  204 000000A8         
  205 000000A8                 EXPORT           OSIntFIQNestIRQ
  206 000000A8         
  207 000000A8                 IMPORT           OSIntFIQNestIRQFlag
  208 000000A8         
  209 000000A8         OSIntFIQNestIRQ
  210 000000A8         
  211 000000A8         ;set OSIntFIQNestIRQ
  212 000000A8 E3A01000        mov              r1,#0
  213 000000AC E14F0000        mrs              r0,spsr
  214 000000B0 E200001F        and              r0,r0,#MODEMASK
  215 000000B4 E3500012        cmp              r0,#IRQMODE
  216 000000B8 1A000001        bne              OSIntFIQNestIRQ_1
  217 000000BC E1A00000        nop
  218 000000C0 E3A01001        mov              r1,#1
  219 000000C4         OSIntFIQNestIRQ_1
  220 000000C4 E59F0334        ldr              r0,=OSIntFIQNestIRQFlag
  221 000000C8 E5801000        str              r1,[r0]
  222 000000CC E12FFF1E        bx               lr
  223 000000D0         
  224 000000D0         ;*******************************************************
                       **************************************************
  225 000000D0         ;                                            IRQ HANDLER
                       
  226 000000D0         ;
  227 000000D0         ;        This handles all the IRQs
  228 000000D0         ;



ARM Macro Assembler    Page 12 


  229 000000D0         ;*******************************************************
                       **************************************************
  230 000000D0         
  231 000000D0         ;//IMPORT  IRQ_Handler             ; In int_handler.c
  232 000000D0                 IMPORT           OSIntIRQEnter
  233 000000D0                 IMPORT           OSIntIRQExit
  234 000000D0         
  235 000000D0                 IMPORT           OSIntIRQCtxSwFlag
  236 000000D0                 IMPORT           OSTCBCur
  237 000000D0                 IMPORT           OSTaskSwHook
  238 000000D0                 IMPORT           OSTCBHighRdy
  239 000000D0                 IMPORT           OSPrioCur
  240 000000D0                 IMPORT           OSPrioHighRdy
  241 000000D0         
  242 000000D0                 IMPORT           marsIntIRQHandler
  243 000000D0         
  244 000000D0                 EXPORT           UCOS_IRQHandler
  245 000000D0         UCOS_IRQHandler
  246 000000D0         
  247 000000D0         ; Fix the return address
  248 000000D0 E24EE004        sub              lr,lr,#4
  249 000000D4 E92D500F        stmfd            sp!,{r0-r3,r12,lr}
  250 000000D8         
  251 000000D8 E3A0020D        mov              r0,#0xd0000000
  252 000000DC E5902014        ldr              r2,[r0,#0x14]
  253 000000E0 E3120002        tst              r2,#2
  254 000000E4 1A000018        BNE              _IRQ_FAIL_EXIT
  255 000000E8         
  256 000000E8         ; Fix K310 IRQ/FIQ bug, enable all IRQ/FIQ mask
  257 000000E8                 IF               (FIXK310BUG == 1)
                               ELIF             (FIXK310BUG == 2)
  272 000000E8 E59F0314        ldr              r0, =RegIntMask
  273 000000EC E3A01003        mov              r1, #0x00000003
  274 000000F0 E5801000        str              r1, [r0]
  275 000000F4                 ENDIF
  276 000000F4         
  277 000000F4         
  278 000000F4         ;chanel piority: 5>1>4>2>3
  279 000000F4                 IF               (SPEEDUPIRQFIQ == 1)
  280 000000F4 E59F030C        ldr              r0, =SdramTimeCtrl
  281 000000F8 E5901000        ldr              r1, [r0]
  282 000000FC E3C11503        bic              r1, r1, #0x00c00000
  283 00000100 E3811502        orr              r1, r1, #0x00800000
  284 00000104 E5801000        str              r1, [r0]
  285 00000108                 ENDIF
  286 00000108         
  287 00000108         ; cytsai: 0421
  288 00000108 E10F0000        mrs              r0,cpsr
  289 0000010C E38000C0        orr              r0,r0,#NOINT
  290 00000110 E121F000        msr              cpsr_c,r0
  291 00000114         
  292 00000114         ; Fix K310 IRQ/FIQ bug, recover IRQ/FIQ mask
  293 00000114                 IF               (FIXK310BUG == 1)
                               ELIF             (FIXK310BUG == 2)
  300 00000114 E59F02E8        ldr              r0, =RegIntMask
  301 00000118 E3A01000        mov              r1, #0x00000000
  302 0000011C E5801000        str              r1, [r0]
  303 00000120                 ENDIF
  304 00000120         



ARM Macro Assembler    Page 13 


  305 00000120 EBFFFFFE        bl               OSIntIRQEnter
  306 00000124 EBFFFFFE        bl               marsIntIRQHandler 
                                                            ;// IRQ_Handler
  307 00000128 EBFFFFFE        bl               OSIntIRQExit
  308 0000012C         
  309 0000012C         ; Is OSIntIRQCtxSwFlag == True ?
  310 0000012C E59F02C4        ldr              r0,=OSIntIRQCtxSwFlag
  311 00000130 E5901000        ldr              r1,[r0]
  312 00000134 E3510001        cmp              r1,#1
  313 00000138 0A000004        beq              _IntIRQCtxSw
  314 0000013C         _IRQExit
  315 0000013C         ; chanel piority: 5>1>2>3>4
  316 0000013C                 IF               (SPEEDUPIRQFIQ == 1)
  317 0000013C E59F02C4        ldr              r0, =SdramTimeCtrl
  318 00000140 E5901000        ldr              r1, [r0]
  319 00000144 E3C11503        bic              r1, r1, #0x00c00000
  320 00000148 E5801000        str              r1, [r0]
  321 0000014C                 ENDIF
  322 0000014C         _IRQ_FAIL_EXIT
  323 0000014C E8FD900F        ldmfd            sp!,{r0-r3,r12,pc}^
  324 00000150         
  325 00000150         
  326 00000150         _IntIRQCtxSw
  327 00000150         ; OSIntIRQCtxSwFlag = False
  328 00000150 E3A01000        mov              r1,#0
  329 00000154 E5801000        str              r1,[r0]
  330 00000158         
  331 00000158         ; Fix K310 IRQ/FIQ bug, enable all IRQ/FIQ mask
  332 00000158                 IF               (FIXK310BUG == 1)
                               ELIF             (FIXK310BUG == 2)
  344 00000158 E59F02A4        ldr              r0, =RegIntMask
  345 0000015C E3A01003        mov              r1, #0x00000003
  346 00000160 E5801000        str              r1, [r0]
  347 00000164                 ENDIF
  348 00000164         
  349 00000164         ; Get old task's sp & lr
  350 00000164 E14F0000        mrs              r0,spsr
  351 00000168 E38000C0        orr              r0,r0,#NOINT
  352 0000016C E3C00020        bic              r0,r0,#TBIT
  353 00000170 E121F000        msr              cpsr_c,r0
  354 00000174 E1A0100D        mov              r1,sp
  355 00000178 E1A0200E        mov              r2,lr
  356 0000017C E3C0001F        bic              r0,r0,#MODEMASK
  357 00000180 E3800012        orr              r0,r0,#IRQMODE
  358 00000184 E121F000        msr              cpsr_c,r0
  359 00000188         
  360 00000188         ; Fix K310 IRQ/FIQ bug, recover IRQ/FIQ mask
  361 00000188                 IF               (FIXK310BUG == 1)
                               ELIF             (FIXK310BUG == 2)
  368 00000188 E59F0274        ldr              r0, =RegIntMask
  369 0000018C E3A03000        mov              r3, #0x00000000
  370 00000190 E5803000        str              r3, [r0]
  371 00000194                 ENDIF
  372 00000194         
  373 00000194         ; Unwind IRQ's sp without poping r0-r3
  374 00000194 E1A0300D        mov              r3,sp
  375 00000198 E28DD010        add              sp,sp,#(4*4)
  376 0000019C E8BD5000        ldmfd            sp!,{r12,lr}
  377 000001A0         



ARM Macro Assembler    Page 14 


  378 000001A0 E9214004        stmfd            r1!,{r2,lr} ; push old task's p
                                                            c & lr
  379 000001A4 E9211FF0        stmfd            r1!,{r4-r12} ; push old task's 
                                                            r12-r4
  380 000001A8         
  381 000001A8         ; Get r0-r3 from IRQ's stack
  382 000001A8 E1A06001        mov              r6,r1
  383 000001AC E893000F        ldmfd            r3,{r0-r3}
  384 000001B0 E926000F        stmfd            r6!,{r0-r3} ; push old task's r
                                                            3-r0
  385 000001B4         
  386 000001B4 E14F3000        mrs              r3,spsr
  387 000001B8 E9260008        stmfd            r6!,{r3}    ; push old task's p
                                                            sr
  388 000001BC E9260008        stmfd            r6!,{r3}    ; push old task's s
                                                            psr (don't care)
  389 000001C0         
  390 000001C0         ; OSPrioCur = OSPrioHighRdy
  391 000001C0 E59F4224        ldr              r4,=OSPrioCur
  392 000001C4 E59F5224        ldr              r5,=OSPrioHighRdy
  393 000001C8 E5D55000        ldrb             r5,[r5]
  394 000001CC E5C45000        strb             r5,[r4]
  395 000001D0         
  396 000001D0         ; Get current task's TCB address
  397 000001D0 E59F421C        ldr              r4,=OSTCBCur
  398 000001D4 E5945000        ldr              r5,[r4]
  399 000001D8 E5856000        str              r6,[r5]     ; store sp in preem
                                                            pted tasks's TCB
  400 000001DC         
  401 000001DC EBFFFFFE        bl               OSTaskSwHook ; call Task Switch
                                                             Hook
  402 000001E0         
  403 000001E0         ; Get highest priority task's TCB address
  404 000001E0 E59F61FC        ldr              r6,=OSTCBHighRdy
  405 000001E4 E5966000        ldr              r6,[r6]
  406 000001E8 E5965000        ldr              r5,[r6]     ; get new task's st
                                                            ack pointer
  407 000001EC         
  408 000001EC         ; OSTCBCur = OSTCBHighRdy
  409 000001EC E5846000        str              r6,[r4]     ; set new current t
                                                            ask TCB address
  410 000001F0         
  411 000001F0 E8B50010        ldmfd            r5!,{r4}    ; pop new task's sp
                                                            sr (don't care)
  412 000001F4 E8B50010        ldmfd            r5!,{r4}    ; pop new task's ps
                                                            r
  413 000001F8         
  414 000001F8         ; Fix K310 IRQ/FIQ bug, enable all IRQ/FIQ mask
  415 000001F8                 IF               (FIXK310BUG == 1)
                               ELIF             (FIXK310BUG == 2)
  427 000001F8 E59F0204        ldr              r0, =RegIntMask
  428 000001FC E3A01003        mov              r1, #0x00000003
  429 00000200 E5801000        str              r1, [r0]
  430 00000204                 ENDIF
  431 00000204         
  432 00000204         ; Leave IRQ mode
  433 00000204 E38400C0        orr              r0,r4,#NOINT
  434 00000208 E3C00020        bic              r0,r0,#TBIT
  435 0000020C E121F000        msr              cpsr_c,r0



ARM Macro Assembler    Page 15 


  436 00000210         
  437 00000210 E16FF004        msr              spsr_cxsf,r4
  438 00000214 E1A0D005        mov              sp,r5
  439 00000218         
  440 00000218         ; Fix K310 IRQ/FIQ bug, recover IRQ/FIQ mask
  441 00000218                 IF               (FIXK310BUG == 1)
                               ELIF             (FIXK310BUG == 2)
  448 00000218 E59F01E4        ldr              r0, =RegIntMask
  449 0000021C E3A01000        mov              r1, #0x00000000
  450 00000220 E5801000        str              r1, [r0]
  451 00000224                 ENDIF
  452 00000224         
  453 00000224         ; chanel piority: 5>1>2>3>4
  454 00000224                 IF               (SPEEDUPIRQFIQ == 1)
  455 00000224 E59F01DC        ldr              r0, =SdramTimeCtrl
  456 00000228 E5901000        ldr              r1, [r0]
  457 0000022C E3C11503        bic              r1, r1, #0x00c00000
  458 00000230 E5801000        str              r1, [r0]
  459 00000234                 ENDIF
  460 00000234         
  461 00000234 E8FDDFFF        ldmfd            sp!,{r0-r12,lr,pc}^ ; pop new t
                                                            ask's r0-r12,lr & p
                                                            c
  462 00000238         
  463 00000238         ;*******************************************************
                       **************************************************
  464 00000238         ;                                            FIQ HANDLER
                       
  465 00000238         ;
  466 00000238         ;        This handles all the FIQs
  467 00000238         ;
  468 00000238         ;*******************************************************
                       **************************************************
  469 00000238         
  470 00000238         ;//IMPORT  FIQ_Handler             ; In int_handler.c
  471 00000238                 IMPORT           OSIntFIQEnter
  472 00000238                 IMPORT           OSIntFIQExit
  473 00000238         
  474 00000238                 IMPORT           OSIntFIQCtxSwFlag
  475 00000238                 IMPORT           OSTCBCur
  476 00000238                 IMPORT           OSTaskSwHook
  477 00000238                 IMPORT           OSTCBHighRdy
  478 00000238                 IMPORT           OSPrioCur
  479 00000238                 IMPORT           OSPrioHighRdy
  480 00000238                 IMPORT           marsIntFIQHandler
  481 00000238         
  482 00000238                 EXPORT           UCOS_FIQHandler
  483 00000238         UCOS_FIQHandler
  484 00000238         
  485 00000238         ; Fix the return address
  486 00000238 E24EE004        sub              lr,lr,#4
  487 0000023C E92D500F        stmfd            sp!,{r0-r3,r12,lr}
  488 00000240         
  489 00000240 E3A0920D        mov              r9,#0xd0000000
  490 00000244 E599A014        ldr              r10,[r9,#0x14]
  491 00000248 E31A0001        tst              r10,#1
  492 0000024C 1A00000F        BNE              _FIQ_DISABLE_EXIT
  493 00000250         
  494 00000250         ; Fix K310 IRQ/FIQ bug



ARM Macro Assembler    Page 16 


  495 00000250                 IF               (FIXK310BUG == 1)
  500                          ENDIF
  501 00000250         
  502 00000250         ;chanel piority: 5>1>4>2>3
  503 00000250                 IF               (SPEEDUPIRQFIQ == 1)
  504 00000250 E59F01B0        ldr              r0, =SdramTimeCtrl
  505 00000254 E5901000        ldr              r1, [r0]
  506 00000258 E3C11503        bic              r1, r1, #0x00c00000
  507 0000025C E3811502        orr              r1, r1, #0x00800000
  508 00000260 E5801000        str              r1, [r0]
  509 00000264                 ENDIF
  510 00000264         
  511 00000264 EBFFFFFE        bl               OSIntFIQEnter
  512 00000268 EBFFFFFE        bl               marsIntFIQHandler ;//FIQ_Handle
                                                            r    ;//
  513 0000026C EBFFFFFE        bl               OSIntFIQExit
  514 00000270         
  515 00000270         ; Is OSIntFIQCtxSwFlag == True ?
  516 00000270 E59F0184        ldr              r0,=OSIntFIQCtxSwFlag
  517 00000274 E5901000        ldr              r1,[r0]
  518 00000278 E3510001        cmp              r1,#1
  519 0000027C 0A000004        beq              _IntFIQCtxSw
  520 00000280         _FIQExit
  521 00000280         ; chanel piority: 5>1>2>3>4
  522 00000280                 IF               (SPEEDUPIRQFIQ == 1)
  523 00000280 E59F0180        ldr              r0, =SdramTimeCtrl
  524 00000284 E5901000        ldr              r1, [r0]
  525 00000288 E3C11503        bic              r1, r1, #0x00c00000
  526 0000028C E5801000        str              r1, [r0]
  527 00000290                 ENDIF
  528 00000290         _FIQ_DISABLE_EXIT
  529 00000290 E8FD900F        ldmfd            sp!,{r0-r3,r12,pc}^
  530 00000294         
  531 00000294         
  532 00000294         _IntFIQCtxSw
  533 00000294         ; OSIntFIQCtxSwFlag = False
  534 00000294 E3A01000        mov              r1,#0
  535 00000298 E5801000        str              r1,[r0]
  536 0000029C         
  537 0000029C         ; Fix K310 IRQ/FIQ bug, enable all IRQ/FIQ mask
  538 0000029C                 IF               (FIXK310BUG == 1)
                               ELIF             (FIXK310BUG == 2)
  550 0000029C E59F0160        ldr              r0, =RegIntMask
  551 000002A0 E3A01003        mov              r1, #0x00000003
  552 000002A4 E5801000        str              r1, [r0]
  553 000002A8                 ENDIF
  554 000002A8         
  555 000002A8         ; Get old task's sp & lr
  556 000002A8 E14F0000        mrs              r0,spsr
  557 000002AC E38000C0        orr              r0,r0,#NOINT
  558 000002B0 E3C00020        bic              r0,r0,#TBIT
  559 000002B4 E121F000        msr              cpsr_c,r0
  560 000002B8 E1A0100D        mov              r1,sp
  561 000002BC E1A0200E        mov              r2,lr
  562 000002C0 E3C0001F        bic              r0,r0,#MODEMASK
  563 000002C4 E3800011        orr              r0,r0,#FIQMODE
  564 000002C8 E121F000        msr              cpsr_c,r0
  565 000002CC         
  566 000002CC         ; Unwind FIQ's sp without poping r0-r3



ARM Macro Assembler    Page 17 


  567 000002CC E1A0300D        mov              r3,sp
  568 000002D0 E28DD010        add              sp,sp,#(4*4)
  569 000002D4 E8BD5000        ldmfd            sp!,{r12,lr}
  570 000002D8         
  571 000002D8 E9214004        stmfd            r1!,{r2,lr} ; push old task's p
                                                            c & lr
  572 000002DC         ;CY 0601 S
  573 000002DC         ;stmfd r1!,{r4-r12}          ; push old task's r12-r4
  574 000002DC         ; Get old task's r4-r12
  575 000002DC E14F0000        mrs              r0,spsr
  576 000002E0 E38000C0        orr              r0,r0,#NOINT
  577 000002E4 E3C00020        bic              r0,r0,#TBIT
  578 000002E8 E121F000        msr              cpsr_c,r0
  579 000002EC E9211FF0        stmfd            r1!,{r4-r12} ; push old task's 
                                                            r12-r4
  580 000002F0 E3C0001F        bic              r0,r0,#MODEMASK
  581 000002F4 E3800011        orr              r0,r0,#FIQMODE
  582 000002F8 E121F000        msr              cpsr_c,r0
  583 000002FC         ;CY 0601 E
  584 000002FC         
  585 000002FC         ; Fix K310 IRQ/FIQ bug, recover IRQ/FIQ mask
  586 000002FC         ;IF (FIXK310BUG == 1)
  587 000002FC         ;    ldr r0, =RegCtrlBase
  588 000002FC         ;    ldr r3, FiqMaskBackupF
  589 000002FC         ;    str r3, [r0, #0x04]
  590 000002FC         ;    ldr r3, IrqMaskBackupF
  591 000002FC         ;    str r3, [r0, #0x10]
  592 000002FC         ;ENDIF
  593 000002FC         
  594 000002FC         ; Get r0-r3 from FIQ's stack
  595 000002FC E1A06001        mov              r6,r1
  596 00000300 E893000F        ldmfd            r3,{r0-r3}
  597 00000304 E926000F        stmfd            r6!,{r0-r3} ; push old task's r
                                                            3-r0
  598 00000308         
  599 00000308 E14F3000        mrs              r3,spsr
  600 0000030C E9260008        stmfd            r6!,{r3}    ; push old task's p
                                                            sr
  601 00000310 E9260008        stmfd            r6!,{r3}    ; push old task's s
                                                            psr (don't care)
  602 00000314         
  603 00000314         ; OSPrioCur = OSPrioHighRdy
  604 00000314 E59F40D0        ldr              r4,=OSPrioCur
  605 00000318 E59F50D0        ldr              r5,=OSPrioHighRdy
  606 0000031C E5D55000        ldrb             r5,[r5]
  607 00000320 E5C45000        strb             r5,[r4]
  608 00000324         
  609 00000324         ; Get current task's TCB address
  610 00000324 E59F40C8        ldr              r4,=OSTCBCur
  611 00000328 E5945000        ldr              r5,[r4]
  612 0000032C E5856000        str              r6,[r5]     ; store sp in preem
                                                            pted tasks's TCB
  613 00000330         
  614 00000330 EBFFFFFE        bl               OSTaskSwHook ; call Task Switch
                                                             Hook
  615 00000334         
  616 00000334         ; Get highest priority task's TCB address
  617 00000334 E59F60A8        ldr              r6,=OSTCBHighRdy
  618 00000338 E5966000        ldr              r6,[r6]



ARM Macro Assembler    Page 18 


  619 0000033C E5965000        ldr              r5,[r6]     ; get new task's st
                                                            ack pointer
  620 00000340         
  621 00000340         ; OSTCBCur = OSTCBHighRdy
  622 00000340 E5846000        str              r6,[r4]     ; set new current t
                                                            ask TCB address
  623 00000344         
  624 00000344 E8B50010        ldmfd            r5!,{r4}    ; pop new task's sp
                                                            sr (don't care)
  625 00000348 E8B50010        ldmfd            r5!,{r4}    ; pop new task's ps
                                                            r
  626 0000034C         
  627 0000034C         ; Fix K310 IRQ/FIQ bug, enable all IRQ/FIQ mask
  628 0000034C         ;IF (FIXK310BUG == 1)
  629 0000034C         ;    ldr r0, =RegCtrlBase
  630 0000034C         ;    ldr r1, [r0, #0x04]
  631 0000034C         ;    ldr r2, =FiqMaskBackupF
  632 0000034C         ;    str r1, [r2]
  633 0000034C         ;    ldr r1, [r0, #0x10]
  634 0000034C         ;    ldr r2, =IrqMaskBackupF
  635 0000034C         ;    str r1, [r2]
  636 0000034C         ;    mov r1, #0xffffffff
  637 0000034C         ;    str r1, [r0, #0x04]
  638 0000034C         ;    str r1, [r0, #0x10]
  639 0000034C         ;ENDIF
  640 0000034C         
  641 0000034C         ; Leave FIQ mode
  642 0000034C E38400C0        orr              r0,r4,#NOINT
  643 00000350 E3C00020        bic              r0,r0,#TBIT
  644 00000354 E121F000        msr              cpsr_c,r0
  645 00000358         
  646 00000358 E16FF004        msr              spsr_cxsf,r4
  647 0000035C E1A0D005        mov              sp,r5
  648 00000360         
  649 00000360         ; Fix K310 IRQ/FIQ bug, recover IRQ/FIQ mask
  650 00000360                 IF               (FIXK310BUG == 1)
                               ELIF             (FIXK310BUG == 2)
  657 00000360 E59F009C        ldr              r0, =RegIntMask
  658 00000364 E3A01000        mov              r1, #0x00000000
  659 00000368 E5801000        str              r1, [r0]
  660 0000036C                 ENDIF
  661 0000036C         
  662 0000036C         ; chanel piority: 5>1>2>3>4
  663 0000036C                 IF               (SPEEDUPIRQFIQ == 1)
  664 0000036C E59F0094        ldr              r0, =SdramTimeCtrl
  665 00000370 E5901000        ldr              r1, [r0]
  666 00000374 E3C11503        bic              r1, r1, #0x00c00000
  667 00000378 E5801000        str              r1, [r0]
  668 0000037C                 ENDIF
  669 0000037C         
  670 0000037C E8FDDFFF        ldmfd            sp!,{r0-r12,lr,pc}^ ; pop new t
                                                            ask's r0-r12,lr & p
                                                            c
  671 00000380         
  672 00000380         ;*******************************************************
                       **************************************************
  673 00000380         ;                                   CRITICAL SECTION MET
                       HOD 3 FUNCTIONS
  674 00000380         ;



ARM Macro Assembler    Page 19 


  675 00000380         ; Description: Disable/Enable interrupts by preserving t
                       he state of interrupts.  Generally speaking you
  676 00000380         ;              would store the state of the interrupt di
                       sable flag in the local variable 'cpu_sr' and then
  677 00000380         ;              disable interrupts.  'cpu_sr' is allocate
                       d in all of uC/OS-II's functions that need to 
  678 00000380         ;              disable interrupts.  You would restore th
                       e interrupt disable state by copying back 'cpu_sr'
  679 00000380         ;              into the CPU's status register.
  680 00000380         ;
  681 00000380         ;              OS_CPU_SR OSCPUSaveSR()
  682 00000380         ; Arguments  : none
  683 00000380         ;
  684 00000380         ; Returns    : OS_CPU_SR
  685 00000380         ;
  686 00000380         ;              OSCPURestoreSR(OS_CPU_SR cpu_sr)
  687 00000380         ; Arguments  : OS_CPU_SR
  688 00000380         ;
  689 00000380         ; Returns    : none
  690 00000380         ;
  691 00000380         ; Note(s)    : These functions are used in general like 
                       this,
  692 00000380         ;
  693 00000380         ;            void Task (void *data)
  694 00000380         ;            {
  695 00000380         ;                    #if OS_CRITICAL_METHOD == 3 /* Allo
                       cate storage for CPU status register */
  696 00000380         ;                          OS_CPU_SR  cpu_sr;
  697 00000380         ;                    #endif
  698 00000380         ;                         :
  699 00000380         ;                         :
  700 00000380         ;                    OS_ENTER_CRITICAL(); /* cpu_sr = OS
                       CPUSaveSR(); */
  701 00000380         ;                         :
  702 00000380         ;                         :
  703 00000380         ;                    OS_EXIT_CRITICAL();  /* OSCPURestor
                       eSR(cpu_sr); */
  704 00000380         ;                         :
  705 00000380         ;                         :
  706 00000380         ;            }
  707 00000380         ;*******************************************************
                       **************************************************
  708 00000380         
  709 00000380                 EXPORT           OSCPUSaveSR
  710 00000380         OSCPUSaveSR
  711 00000380         
  712 00000380         ; Fix K310 IRQ/FIQ bug, enable all IRQ/FIQ mask
  713 00000380                 IF               (FIXK310BUG == 1)
                               ELIF             (FIXK310BUG == 2)
  733 00000380 E92D000E        stmfd            sp!,{r1-r3}
  734 00000384 E59F2078        ldr              r2, =RegIntMask
  735 00000388 E3A03003        mov              r3, #0x00000003
  736 0000038C E5823000        str              r3, [r2]
  737 00000390         ;ldmfd sp!,{r1-r3}
  738 00000390                 ENDIF
  739 00000390         
  740 00000390 E10F0000        mrs              r0,CPSR
  741 00000394 E38010C0        orr              r1,r0,#NOINT
  742 00000398 E121F001        msr              CPSR_c,r1



ARM Macro Assembler    Page 20 


  743 0000039C         
  744 0000039C         ; Fix K310 IRQ/FIQ bug, recover IRQ/FIQ mask
  745 0000039C                 IF               (FIXK310BUG == 1)
                               ELIF             (FIXK310BUG == 2)
  753 0000039C E59F2060        ldr              r2, =RegIntMask
  754 000003A0 E3A03000        mov              r3, #0x00000000
  755 000003A4 E5823000        str              r3, [r2]
  756 000003A8 E8BD000E        ldmfd            sp!,{r1-r3}
  757 000003AC                 ENDIF
  758 000003AC         
  759 000003AC E12FFF1E        bx               lr
  760 000003B0         
  761 000003B0         
  762 000003B0                 EXPORT           OSCPURestoreSR
  763 000003B0         OSCPURestoreSR
  764 000003B0         
  765 000003B0                 IF               (FIXK310BUG == 2)
  766 000003B0 E92D0006        stmfd            sp!,{r1-r2}
  767 000003B4 E59F1048        ldr              r1, =RegIntMask
  768 000003B8 E3A02003        mov              r2, #0x00000003
  769 000003BC E5812000        str              r2, [r1]
  770 000003C0 E8BD0006        ldmfd            sp!,{r1-r2}
  771 000003C4                 ENDIF
  772 000003C4         
  773 000003C4 E121F000        msr              CPSR_c,r0
  774 000003C8         
  775 000003C8                 IF               (FIXK310BUG == 2)
  776 000003C8 E92D0006        stmfd            sp!,{r1-r2}
  777 000003CC E59F1030        ldr              r1, =RegIntMask
  778 000003D0 E3A02000        mov              r2, #0x00000000
  779 000003D4 E5812000        str              r2, [r1]
  780 000003D8 E8BD0006        ldmfd            sp!,{r1-r2}
  781 000003DC                 ENDIF
  782 000003DC         
  783 000003DC E12FFF1E        bx               lr
  784 000003E0         
  785 000003E0         ; Fix K310 IRQ/FIQ bug
  786 000003E0                 IF               (FIXK310BUG == 1)
  793                          ENDIF
  794 000003E0         
  795 000003E0         ; for K310 debug
  796 000003E0         ;        EXPORT  Read_LR
  797 000003E0         ;Read_LR
  798 000003E0         ;        mov     r0, sp
  799 000003E0         ;        ldmfd   sp,{r0}
  800 000003E0         ;        bx      lr
  801 000003E0         
  802 000003E0                 END
              00000000 
              00000000 
              DEAD1EAF 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              D0000014 
              C0040038 



ARM Macro Assembler    Page 21 


Command Line: --debug --xref --diag_suppress=9931 --depend=.\out\obj\os_cpu_a.d
 -o.\out\obj\os_cpu_a.o -I.\inc -IC:\Keil_v5\ARM\RV31\INC -IC:\Keil_v5\ARM\CMSI
S\Include --predefine="__UVISION_VERSION SETA 518" --predefine="USE_SCATTER_SYM
S SETA 1" --list=.\out\lst\os_cpu_a.lst ucos_ii\src\OS_CPU_A.S



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
Relocatable symbols

OSCPURestoreSR 000003B0

Symbol: OSCPURestoreSR
   Definitions
      At line 763 in file ucos_ii\src\OS_CPU_A.S
   Uses
      At line 762 in file ucos_ii\src\OS_CPU_A.S
Comment: OSCPURestoreSR used once
OSCPUSaveSR 00000380

Symbol: OSCPUSaveSR
   Definitions
      At line 710 in file ucos_ii\src\OS_CPU_A.S
   Uses
      At line 709 in file ucos_ii\src\OS_CPU_A.S
Comment: OSCPUSaveSR used once
OSCtxSw 0000002C

Symbol: OSCtxSw
   Definitions
      At line 116 in file ucos_ii\src\OS_CPU_A.S
   Uses
      At line 114 in file ucos_ii\src\OS_CPU_A.S
Comment: OSCtxSw used once
OSIntFIQCtxSw 00000098

Symbol: OSIntFIQCtxSw
   Definitions
      At line 189 in file ucos_ii\src\OS_CPU_A.S
   Uses
      At line 185 in file ucos_ii\src\OS_CPU_A.S
Comment: OSIntFIQCtxSw used once
OSIntFIQNestIRQ 000000A8

Symbol: OSIntFIQNestIRQ
   Definitions
      At line 209 in file ucos_ii\src\OS_CPU_A.S
   Uses
      At line 205 in file ucos_ii\src\OS_CPU_A.S
Comment: OSIntFIQNestIRQ used once
OSIntFIQNestIRQ_1 000000C4

Symbol: OSIntFIQNestIRQ_1
   Definitions
      At line 219 in file ucos_ii\src\OS_CPU_A.S
   Uses
      At line 216 in file ucos_ii\src\OS_CPU_A.S
Comment: OSIntFIQNestIRQ_1 used once
OSIntIRQCtxSw 00000088

Symbol: OSIntIRQCtxSw
   Definitions
      At line 169 in file ucos_ii\src\OS_CPU_A.S
   Uses
      At line 167 in file ucos_ii\src\OS_CPU_A.S
Comment: OSIntIRQCtxSw used once
OSStartHighRdy 00000000

Symbol: OSStartHighRdy



ARM Macro Assembler    Page 2 Alphabetic symbol ordering
Relocatable symbols

   Definitions
      At line 80 in file ucos_ii\src\OS_CPU_A.S
   Uses
      At line 78 in file ucos_ii\src\OS_CPU_A.S
Comment: OSStartHighRdy used once
UCOS_ARM 00000000

Symbol: UCOS_ARM
   Definitions
      At line 62 in file ucos_ii\src\OS_CPU_A.S
   Uses
      None
Comment: UCOS_ARM unused
UCOS_FIQHandler 00000238

Symbol: UCOS_FIQHandler
   Definitions
      At line 483 in file ucos_ii\src\OS_CPU_A.S
   Uses
      At line 482 in file ucos_ii\src\OS_CPU_A.S
Comment: UCOS_FIQHandler used once
UCOS_IRQHandler 000000D0

Symbol: UCOS_IRQHandler
   Definitions
      At line 245 in file ucos_ii\src\OS_CPU_A.S
   Uses
      At line 244 in file ucos_ii\src\OS_CPU_A.S
Comment: UCOS_IRQHandler used once
_FIQExit 00000280

Symbol: _FIQExit
   Definitions
      At line 520 in file ucos_ii\src\OS_CPU_A.S
   Uses
      None
Comment: _FIQExit unused
_FIQ_DISABLE_EXIT 00000290

Symbol: _FIQ_DISABLE_EXIT
   Definitions
      At line 528 in file ucos_ii\src\OS_CPU_A.S
   Uses
      At line 492 in file ucos_ii\src\OS_CPU_A.S
Comment: _FIQ_DISABLE_EXIT used once
_IRQExit 0000013C

Symbol: _IRQExit
   Definitions
      At line 314 in file ucos_ii\src\OS_CPU_A.S
   Uses
      None
Comment: _IRQExit unused
_IRQ_FAIL_EXIT 0000014C

Symbol: _IRQ_FAIL_EXIT
   Definitions
      At line 322 in file ucos_ii\src\OS_CPU_A.S
   Uses



ARM Macro Assembler    Page 3 Alphabetic symbol ordering
Relocatable symbols

      At line 254 in file ucos_ii\src\OS_CPU_A.S
Comment: _IRQ_FAIL_EXIT used once
_IntFIQCtxSw 00000294

Symbol: _IntFIQCtxSw
   Definitions
      At line 532 in file ucos_ii\src\OS_CPU_A.S
   Uses
      At line 519 in file ucos_ii\src\OS_CPU_A.S
Comment: _IntFIQCtxSw used once
_IntIRQCtxSw 00000150

Symbol: _IntIRQCtxSw
   Definitions
      At line 326 in file ucos_ii\src\OS_CPU_A.S
   Uses
      At line 313 in file ucos_ii\src\OS_CPU_A.S
Comment: _IntIRQCtxSw used once
17 symbols



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
Absolute symbols

ABORTMODE 00000017

Symbol: ABORTMODE
   Definitions
      At line 30 in file ucos_ii\src\OS_CPU_A.S
   Uses
      None
Comment: ABORTMODE unused
CHIP_OPT_A1013A 00000010

Symbol: CHIP_OPT_A1013A
   Definitions
      At line 95 in file ucos_ii\src\..\..\inc\.\sysoptdef.inc
   Uses
      At line 48 in file ucos_ii\src\OS_CPU_A.S
Comment: CHIP_OPT_A1013A used once
CHIP_OPT_A1013A_FPGA 00000011

Symbol: CHIP_OPT_A1013A_FPGA
   Definitions
      At line 96 in file ucos_ii\src\..\..\inc\.\sysoptdef.inc
   Uses
      At line 48 in file ucos_ii\src\OS_CPU_A.S
Comment: CHIP_OPT_A1013A_FPGA used once
CHIP_OPT_A1013B 00000012

Symbol: CHIP_OPT_A1013B
   Definitions
      At line 98 in file ucos_ii\src\..\..\inc\.\sysoptdef.inc
   Uses
      At line 53 in file ucos_ii\src\OS_CPU_A.S
Comment: CHIP_OPT_A1013B used once
CHIP_OPT_A1013B_FPGA 00000013

Symbol: CHIP_OPT_A1013B_FPGA
   Definitions
      At line 99 in file ucos_ii\src\..\..\inc\.\sysoptdef.inc
   Uses
      At line 53 in file ucos_ii\src\OS_CPU_A.S
Comment: CHIP_OPT_A1013B_FPGA used once
CHIP_OPT_A1016A 00000007

Symbol: CHIP_OPT_A1016A
   Definitions
      At line 88 in file ucos_ii\src\..\..\inc\.\sysoptdef.inc
   Uses
      At line 61 in file ucos_ii\src\..\..\inc\sysopt.inc
      At line 43 in file ucos_ii\src\OS_CPU_A.S
      At line 53 in file ucos_ii\src\OS_CPU_A.S

CHIP_OPT_A1016A_FPGA 00000008

Symbol: CHIP_OPT_A1016A_FPGA
   Definitions
      At line 89 in file ucos_ii\src\..\..\inc\.\sysoptdef.inc
   Uses
      At line 53 in file ucos_ii\src\OS_CPU_A.S
Comment: CHIP_OPT_A1016A_FPGA used once
CHIP_OPT_A1018A 00000009



ARM Macro Assembler    Page 2 Alphabetic symbol ordering
Absolute symbols


Symbol: CHIP_OPT_A1018A
   Definitions
      At line 91 in file ucos_ii\src\..\..\inc\.\sysoptdef.inc
   Uses
      At line 53 in file ucos_ii\src\OS_CPU_A.S
Comment: CHIP_OPT_A1018A used once
CHIP_OPT_A1018A_FPGA 0000000A

Symbol: CHIP_OPT_A1018A_FPGA
   Definitions
      At line 92 in file ucos_ii\src\..\..\inc\.\sysoptdef.inc
   Uses
      At line 53 in file ucos_ii\src\OS_CPU_A.S
Comment: CHIP_OPT_A1018A_FPGA used once
CHIP_OPT_A1019A 00000014

Symbol: CHIP_OPT_A1019A
   Definitions
      At line 101 in file ucos_ii\src\..\..\inc\.\sysoptdef.inc
   Uses
      At line 53 in file ucos_ii\src\OS_CPU_A.S
Comment: CHIP_OPT_A1019A used once
CHIP_OPT_A1020A 00000015

Symbol: CHIP_OPT_A1020A
   Definitions
      At line 102 in file ucos_ii\src\..\..\inc\.\sysoptdef.inc
   Uses
      At line 57 in file ucos_ii\src\OS_CPU_A.S
Comment: CHIP_OPT_A1020A used once
CHIP_OPT_A1021A 00000016

Symbol: CHIP_OPT_A1021A
   Definitions
      At line 103 in file ucos_ii\src\..\..\inc\.\sysoptdef.inc
   Uses
      At line 57 in file ucos_ii\src\OS_CPU_A.S
Comment: CHIP_OPT_A1021A used once
CHIP_OPT_A1022A 00000017

Symbol: CHIP_OPT_A1022A
   Definitions
      At line 104 in file ucos_ii\src\..\..\inc\.\sysoptdef.inc
   Uses
      At line 57 in file ucos_ii\src\OS_CPU_A.S
Comment: CHIP_OPT_A1022A used once
CHIP_OPT_PA9001A 00000000

Symbol: CHIP_OPT_PA9001A
   Definitions
      At line 80 in file ucos_ii\src\..\..\inc\.\sysoptdef.inc
   Uses
      None
Comment: CHIP_OPT_PA9001A unused
CHIP_OPT_PA9001C 00000001

Symbol: CHIP_OPT_PA9001C
   Definitions



ARM Macro Assembler    Page 3 Alphabetic symbol ordering
Absolute symbols

      At line 81 in file ucos_ii\src\..\..\inc\.\sysoptdef.inc
   Uses
      None
Comment: CHIP_OPT_PA9001C unused
CHIP_OPT_PA9001D 00000003

Symbol: CHIP_OPT_PA9001D
   Definitions
      At line 83 in file ucos_ii\src\..\..\inc\.\sysoptdef.inc
   Uses
      None
Comment: CHIP_OPT_PA9001D unused
CHIP_OPT_PA9002A 00000002

Symbol: CHIP_OPT_PA9002A
   Definitions
      At line 82 in file ucos_ii\src\..\..\inc\.\sysoptdef.inc
   Uses
      None
Comment: CHIP_OPT_PA9002A unused
CHIP_OPT_PA9002C 00000004

Symbol: CHIP_OPT_PA9002C
   Definitions
      At line 84 in file ucos_ii\src\..\..\inc\.\sysoptdef.inc
   Uses
      None
Comment: CHIP_OPT_PA9002C unused
CHIP_OPT_PA9002D 00000006

Symbol: CHIP_OPT_PA9002D
   Definitions
      At line 86 in file ucos_ii\src\..\..\inc\.\sysoptdef.inc
   Uses
      None
Comment: CHIP_OPT_PA9002D unused
CLK_ADC_DIV 00000001

Symbol: CLK_ADC_DIV
   Definitions
      At line 116 in file ucos_ii\src\..\..\inc\sysopt.inc
   Uses
      None
Comment: CLK_ADC_DIV unused
CLK_IDU_DIV 00000001

Symbol: CLK_IDU_DIV
   Definitions
      At line 104 in file ucos_ii\src\..\..\inc\sysopt.inc
   Uses
      None
Comment: CLK_IDU_DIV unused
CLK_JPEG_VLC_DIV 00000002

Symbol: CLK_JPEG_VLC_DIV
   Definitions
      At line 120 in file ucos_ii\src\..\..\inc\sysopt.inc
   Uses
      None



ARM Macro Assembler    Page 4 Alphabetic symbol ordering
Absolute symbols

Comment: CLK_JPEG_VLC_DIV unused
CLK_MCK_DIV 00000002

Symbol: CLK_MCK_DIV
   Definitions
      At line 98 in file ucos_ii\src\..\..\inc\sysopt.inc
   Uses
      None
Comment: CLK_MCK_DIV unused
CLK_SRC_FREQ 01E84800

Symbol: CLK_SRC_FREQ
   Definitions
      At line 92 in file ucos_ii\src\..\..\inc\sysopt.inc
   Uses
      None
Comment: CLK_SRC_FREQ unused
CLK_SRC_OPT 00000000

Symbol: CLK_SRC_OPT
   Definitions
      At line 76 in file ucos_ii\src\..\..\inc\sysopt.inc
   Uses
      None
Comment: CLK_SRC_OPT unused
CLK_SRC_PLLOUT_PA9001C_162M 00000002

Symbol: CLK_SRC_PLLOUT_PA9001C_162M
   Definitions
      At line 56 in file ucos_ii\src\..\..\inc\.\sysoptdef.inc
   Uses
      None
Comment: CLK_SRC_PLLOUT_PA9001C_162M unused
CLK_SRC_PLLOUT_PA9001C_216M 00000003

Symbol: CLK_SRC_PLLOUT_PA9001C_216M
   Definitions
      At line 57 in file ucos_ii\src\..\..\inc\.\sysoptdef.inc
   Uses
      None
Comment: CLK_SRC_PLLOUT_PA9001C_216M unused
CLK_SRC_PLLOUT_PA9001C_64_8M 00000001

Symbol: CLK_SRC_PLLOUT_PA9001C_64_8M
   Definitions
      At line 55 in file ucos_ii\src\..\..\inc\.\sysoptdef.inc
   Uses
      None
Comment: CLK_SRC_PLLOUT_PA9001C_64_8M unused
CLK_SRC_PLLOUT_PA9001D_48M 00000000

Symbol: CLK_SRC_PLLOUT_PA9001D_48M
   Definitions
      At line 54 in file ucos_ii\src\..\..\inc\.\sysoptdef.inc
   Uses
      None
Comment: CLK_SRC_PLLOUT_PA9001D_48M unused
CLK_SRC_PLLOUT_PA9002D_192M 3F480000




ARM Macro Assembler    Page 5 Alphabetic symbol ordering
Absolute symbols

Symbol: CLK_SRC_PLLOUT_PA9002D_192M
   Definitions
      At line 60 in file ucos_ii\src\..\..\inc\.\sysoptdef.inc
   Uses
      None
Comment: CLK_SRC_PLLOUT_PA9002D_192M unused
CLK_SRC_PLLOUT_PA9002D_48M 3F680000

Symbol: CLK_SRC_PLLOUT_PA9002D_48M
   Definitions
      At line 59 in file ucos_ii\src\..\..\inc\.\sysoptdef.inc
   Uses
      None
Comment: CLK_SRC_PLLOUT_PA9002D_48M unused
CLK_SRC_PLLOUT_PA9003A_48M 3F680000

Symbol: CLK_SRC_PLLOUT_PA9003A_48M
   Definitions
      At line 62 in file ucos_ii\src\..\..\inc\.\sysoptdef.inc
   Uses
      None
Comment: CLK_SRC_PLLOUT_PA9003A_48M unused
CLK_SRC_PLLOUT_PA9003A_96M 3F181000

Symbol: CLK_SRC_PLLOUT_PA9003A_96M
   Definitions
      At line 63 in file ucos_ii\src\..\..\inc\.\sysoptdef.inc
   Uses
      None
Comment: CLK_SRC_PLLOUT_PA9003A_96M unused
CLK_SRC_PLLOUT_PA9003A_FPGA 00000000

Symbol: CLK_SRC_PLLOUT_PA9003A_FPGA
   Definitions
      At line 64 in file ucos_ii\src\..\..\inc\.\sysoptdef.inc
   Uses
      At line 76 in file ucos_ii\src\..\..\inc\sysopt.inc
Comment: CLK_SRC_PLLOUT_PA9003A_FPGA used once
CLK_SRC_XIN 00000000

Symbol: CLK_SRC_XIN
   Definitions
      At line 53 in file ucos_ii\src\..\..\inc\.\sysoptdef.inc
   Uses
      None
Comment: CLK_SRC_XIN unused
CLK_WDT_DIV 00000200

Symbol: CLK_WDT_DIV
   Definitions
      At line 109 in file ucos_ii\src\..\..\inc\sysopt.inc
   Uses
      None
Comment: CLK_WDT_DIV unused
CODE_DEVICE_OPT 00000001

Symbol: CODE_DEVICE_OPT
   Definitions
      At line 42 in file ucos_ii\src\..\..\inc\sysopt.inc



ARM Macro Assembler    Page 6 Alphabetic symbol ordering
Absolute symbols

   Uses
      None
Comment: CODE_DEVICE_OPT unused
CODE_STR_EEPROM 00000009

Symbol: CODE_STR_EEPROM
   Definitions
      At line 42 in file ucos_ii\src\..\..\inc\.\sysoptdef.inc
   Uses
      None
Comment: CODE_STR_EEPROM unused
CODE_STR_RAM 00000001

Symbol: CODE_STR_RAM
   Definitions
      At line 43 in file ucos_ii\src\..\..\inc\.\sysoptdef.inc
   Uses
      At line 42 in file ucos_ii\src\..\..\inc\sysopt.inc
Comment: CODE_STR_RAM used once
CODE_STR_ROMTER 00000009

Symbol: CODE_STR_ROMTER
   Definitions
      At line 41 in file ucos_ii\src\..\..\inc\.\sysoptdef.inc
   Uses
      None
Comment: CODE_STR_ROMTER unused
DRAM_CLK_INV_FIRST 00000000

Symbol: DRAM_CLK_INV_FIRST
   Definitions
      At line 85 in file ucos_ii\src\..\..\inc\sysopt.inc
   Uses
      None
Comment: DRAM_CLK_INV_FIRST unused
FIQMODE 00000011

Symbol: FIQMODE
   Definitions
      At line 27 in file ucos_ii\src\OS_CPU_A.S
   Uses
      At line 563 in file ucos_ii\src\OS_CPU_A.S
      At line 581 in file ucos_ii\src\OS_CPU_A.S

FIXK310BUG 00000002

Symbol: FIXK310BUG
   Definitions
      At line 54 in file ucos_ii\src\OS_CPU_A.S
   Uses
      At line 257 in file ucos_ii\src\OS_CPU_A.S
      At line 271 in file ucos_ii\src\OS_CPU_A.S
      At line 293 in file ucos_ii\src\OS_CPU_A.S
      At line 299 in file ucos_ii\src\OS_CPU_A.S
      At line 332 in file ucos_ii\src\OS_CPU_A.S
      At line 343 in file ucos_ii\src\OS_CPU_A.S
      At line 361 in file ucos_ii\src\OS_CPU_A.S
      At line 367 in file ucos_ii\src\OS_CPU_A.S
      At line 415 in file ucos_ii\src\OS_CPU_A.S



ARM Macro Assembler    Page 7 Alphabetic symbol ordering
Absolute symbols

      At line 426 in file ucos_ii\src\OS_CPU_A.S
      At line 441 in file ucos_ii\src\OS_CPU_A.S
      At line 447 in file ucos_ii\src\OS_CPU_A.S
      At line 495 in file ucos_ii\src\OS_CPU_A.S
      At line 538 in file ucos_ii\src\OS_CPU_A.S
      At line 549 in file ucos_ii\src\OS_CPU_A.S
      At line 650 in file ucos_ii\src\OS_CPU_A.S
      At line 656 in file ucos_ii\src\OS_CPU_A.S
      At line 713 in file ucos_ii\src\OS_CPU_A.S
      At line 732 in file ucos_ii\src\OS_CPU_A.S
      At line 745 in file ucos_ii\src\OS_CPU_A.S
      At line 752 in file ucos_ii\src\OS_CPU_A.S
      At line 765 in file ucos_ii\src\OS_CPU_A.S
      At line 775 in file ucos_ii\src\OS_CPU_A.S
      At line 786 in file ucos_ii\src\OS_CPU_A.S

FPGA_OPT_PA9002B 00000005

Symbol: FPGA_OPT_PA9002B
   Definitions
      At line 85 in file ucos_ii\src\..\..\inc\.\sysoptdef.inc
   Uses
      None
Comment: FPGA_OPT_PA9002B unused
IRQMODE 00000012

Symbol: IRQMODE
   Definitions
      At line 28 in file ucos_ii\src\OS_CPU_A.S
   Uses
      At line 215 in file ucos_ii\src\OS_CPU_A.S
      At line 357 in file ucos_ii\src\OS_CPU_A.S

MODEMASK 0000001F

Symbol: MODEMASK
   Definitions
      At line 32 in file ucos_ii\src\OS_CPU_A.S
   Uses
      At line 214 in file ucos_ii\src\OS_CPU_A.S
      At line 356 in file ucos_ii\src\OS_CPU_A.S
      At line 562 in file ucos_ii\src\OS_CPU_A.S
      At line 580 in file ucos_ii\src\OS_CPU_A.S

NOINT 000000C0

Symbol: NOINT
   Definitions
      At line 33 in file ucos_ii\src\OS_CPU_A.S
   Uses
      At line 289 in file ucos_ii\src\OS_CPU_A.S
      At line 351 in file ucos_ii\src\OS_CPU_A.S
      At line 433 in file ucos_ii\src\OS_CPU_A.S
      At line 557 in file ucos_ii\src\OS_CPU_A.S
      At line 576 in file ucos_ii\src\OS_CPU_A.S
      At line 642 in file ucos_ii\src\OS_CPU_A.S
      At line 741 in file ucos_ii\src\OS_CPU_A.S

RegCtrlBase D0000000



ARM Macro Assembler    Page 8 Alphabetic symbol ordering
Absolute symbols


Symbol: RegCtrlBase
   Definitions
      At line 37 in file ucos_ii\src\OS_CPU_A.S
   Uses
      None
Comment: RegCtrlBase unused
RegFiqMask D0000004

Symbol: RegFiqMask
   Definitions
      At line 38 in file ucos_ii\src\OS_CPU_A.S
   Uses
      None
Comment: RegFiqMask unused
RegIntMask D0000014

Symbol: RegIntMask
   Definitions
      At line 40 in file ucos_ii\src\OS_CPU_A.S
   Uses
      At line 272 in file ucos_ii\src\OS_CPU_A.S
      At line 300 in file ucos_ii\src\OS_CPU_A.S
      At line 344 in file ucos_ii\src\OS_CPU_A.S
      At line 368 in file ucos_ii\src\OS_CPU_A.S
      At line 427 in file ucos_ii\src\OS_CPU_A.S
      At line 448 in file ucos_ii\src\OS_CPU_A.S
      At line 550 in file ucos_ii\src\OS_CPU_A.S
      At line 657 in file ucos_ii\src\OS_CPU_A.S
      At line 734 in file ucos_ii\src\OS_CPU_A.S
      At line 753 in file ucos_ii\src\OS_CPU_A.S
      At line 767 in file ucos_ii\src\OS_CPU_A.S
      At line 777 in file ucos_ii\src\OS_CPU_A.S

RegIrqMask D0000010

Symbol: RegIrqMask
   Definitions
      At line 39 in file ucos_ii\src\OS_CPU_A.S
   Uses
      None
Comment: RegIrqMask unused
SPEEDUPIRQFIQ 00000001

Symbol: SPEEDUPIRQFIQ
   Definitions
      At line 55 in file ucos_ii\src\OS_CPU_A.S
   Uses
      At line 279 in file ucos_ii\src\OS_CPU_A.S
      At line 316 in file ucos_ii\src\OS_CPU_A.S
      At line 454 in file ucos_ii\src\OS_CPU_A.S
      At line 503 in file ucos_ii\src\OS_CPU_A.S
      At line 522 in file ucos_ii\src\OS_CPU_A.S
      At line 663 in file ucos_ii\src\OS_CPU_A.S

SVCMODE 00000013

Symbol: SVCMODE
   Definitions



ARM Macro Assembler    Page 9 Alphabetic symbol ordering
Absolute symbols

      At line 29 in file ucos_ii\src\OS_CPU_A.S
   Uses
      None
Comment: SVCMODE unused
SdramTimeCtrl C0040038

Symbol: SdramTimeCtrl
   Definitions
      At line 41 in file ucos_ii\src\OS_CPU_A.S
   Uses
      At line 280 in file ucos_ii\src\OS_CPU_A.S
      At line 317 in file ucos_ii\src\OS_CPU_A.S
      At line 455 in file ucos_ii\src\OS_CPU_A.S
      At line 504 in file ucos_ii\src\OS_CPU_A.S
      At line 523 in file ucos_ii\src\OS_CPU_A.S
      At line 664 in file ucos_ii\src\OS_CPU_A.S

TBIT 00000020

Symbol: TBIT
   Definitions
      At line 34 in file ucos_ii\src\OS_CPU_A.S
   Uses
      At line 352 in file ucos_ii\src\OS_CPU_A.S
      At line 434 in file ucos_ii\src\OS_CPU_A.S
      At line 558 in file ucos_ii\src\OS_CPU_A.S
      At line 577 in file ucos_ii\src\OS_CPU_A.S
      At line 643 in file ucos_ii\src\OS_CPU_A.S

UNDEFMODE 0000001B

Symbol: UNDEFMODE
   Definitions
      At line 31 in file ucos_ii\src\OS_CPU_A.S
   Uses
      None
Comment: UNDEFMODE unused
USERMODE 00000010

Symbol: USERMODE
   Definitions
      At line 26 in file ucos_ii\src\OS_CPU_A.S
   Uses
      None
Comment: USERMODE unused
57 symbols



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
External symbols

OSIntFIQCtxSwFlag 00000000

Symbol: OSIntFIQCtxSwFlag
   Definitions
      At line 187 in file ucos_ii\src\OS_CPU_A.S
      At line 474 in file ucos_ii\src\OS_CPU_A.S
   Uses
      At line 192 in file ucos_ii\src\OS_CPU_A.S
      At line 516 in file ucos_ii\src\OS_CPU_A.S
Warning: OSIntFIQCtxSwFlag multiply defined
OSIntFIQEnter 00000000

Symbol: OSIntFIQEnter
   Definitions
      At line 471 in file ucos_ii\src\OS_CPU_A.S
   Uses
      At line 511 in file ucos_ii\src\OS_CPU_A.S
Comment: OSIntFIQEnter used once
OSIntFIQExit 00000000

Symbol: OSIntFIQExit
   Definitions
      At line 472 in file ucos_ii\src\OS_CPU_A.S
   Uses
      At line 513 in file ucos_ii\src\OS_CPU_A.S
Comment: OSIntFIQExit used once
OSIntFIQNestIRQFlag 00000000

Symbol: OSIntFIQNestIRQFlag
   Definitions
      At line 207 in file ucos_ii\src\OS_CPU_A.S
   Uses
      At line 220 in file ucos_ii\src\OS_CPU_A.S
Comment: OSIntFIQNestIRQFlag used once
OSIntIRQCtxSwFlag 00000000

Symbol: OSIntIRQCtxSwFlag
   Definitions
      At line 165 in file ucos_ii\src\OS_CPU_A.S
      At line 235 in file ucos_ii\src\OS_CPU_A.S
   Uses
      At line 172 in file ucos_ii\src\OS_CPU_A.S
      At line 310 in file ucos_ii\src\OS_CPU_A.S
Warning: OSIntIRQCtxSwFlag multiply defined
OSIntIRQEnter 00000000

Symbol: OSIntIRQEnter
   Definitions
      At line 232 in file ucos_ii\src\OS_CPU_A.S
   Uses
      At line 305 in file ucos_ii\src\OS_CPU_A.S
Comment: OSIntIRQEnter used once
OSIntIRQExit 00000000

Symbol: OSIntIRQExit
   Definitions
      At line 233 in file ucos_ii\src\OS_CPU_A.S
   Uses
      At line 307 in file ucos_ii\src\OS_CPU_A.S



ARM Macro Assembler    Page 2 Alphabetic symbol ordering
External symbols

Comment: OSIntIRQExit used once
OSPrioCur 00000000

Symbol: OSPrioCur
   Definitions
      At line 111 in file ucos_ii\src\OS_CPU_A.S
      At line 239 in file ucos_ii\src\OS_CPU_A.S
      At line 478 in file ucos_ii\src\OS_CPU_A.S
   Uses
      At line 130 in file ucos_ii\src\OS_CPU_A.S
      At line 391 in file ucos_ii\src\OS_CPU_A.S
      At line 604 in file ucos_ii\src\OS_CPU_A.S
Warning: OSPrioCur multiply defined
OSPrioHighRdy 00000000

Symbol: OSPrioHighRdy
   Definitions
      At line 112 in file ucos_ii\src\OS_CPU_A.S
      At line 240 in file ucos_ii\src\OS_CPU_A.S
      At line 479 in file ucos_ii\src\OS_CPU_A.S
   Uses
      At line 131 in file ucos_ii\src\OS_CPU_A.S
      At line 392 in file ucos_ii\src\OS_CPU_A.S
      At line 605 in file ucos_ii\src\OS_CPU_A.S
Warning: OSPrioHighRdy multiply defined
OSRunning 00000000

Symbol: OSRunning
   Definitions
      At line 75 in file ucos_ii\src\OS_CPU_A.S
   Uses
      At line 84 in file ucos_ii\src\OS_CPU_A.S
Comment: OSRunning used once
OSTCBCur 00000000

Symbol: OSTCBCur
   Definitions
      At line 108 in file ucos_ii\src\OS_CPU_A.S
      At line 236 in file ucos_ii\src\OS_CPU_A.S
      At line 475 in file ucos_ii\src\OS_CPU_A.S
   Uses
      At line 136 in file ucos_ii\src\OS_CPU_A.S
      At line 397 in file ucos_ii\src\OS_CPU_A.S
      At line 610 in file ucos_ii\src\OS_CPU_A.S
Warning: OSTCBCur multiply defined
OSTCBHighRdy 00000000

Symbol: OSTCBHighRdy
   Definitions
      At line 76 in file ucos_ii\src\OS_CPU_A.S
      At line 110 in file ucos_ii\src\OS_CPU_A.S
      At line 238 in file ucos_ii\src\OS_CPU_A.S
      At line 477 in file ucos_ii\src\OS_CPU_A.S
   Uses
      At line 88 in file ucos_ii\src\OS_CPU_A.S
      At line 143 in file ucos_ii\src\OS_CPU_A.S
      At line 404 in file ucos_ii\src\OS_CPU_A.S
      At line 617 in file ucos_ii\src\OS_CPU_A.S
Warning: OSTCBHighRdy multiply defined



ARM Macro Assembler    Page 3 Alphabetic symbol ordering
External symbols

OSTaskSwHook 00000000

Symbol: OSTaskSwHook
   Definitions
      At line 74 in file ucos_ii\src\OS_CPU_A.S
      At line 109 in file ucos_ii\src\OS_CPU_A.S
      At line 237 in file ucos_ii\src\OS_CPU_A.S
      At line 476 in file ucos_ii\src\OS_CPU_A.S
   Uses
      At line 82 in file ucos_ii\src\OS_CPU_A.S
      At line 140 in file ucos_ii\src\OS_CPU_A.S
      At line 401 in file ucos_ii\src\OS_CPU_A.S
      At line 614 in file ucos_ii\src\OS_CPU_A.S
Warning: OSTaskSwHook multiply defined
marsIntFIQHandler 00000000

Symbol: marsIntFIQHandler
   Definitions
      At line 480 in file ucos_ii\src\OS_CPU_A.S
   Uses
      At line 512 in file ucos_ii\src\OS_CPU_A.S
Comment: marsIntFIQHandler used once
marsIntIRQHandler 00000000

Symbol: marsIntIRQHandler
   Definitions
      At line 242 in file ucos_ii\src\OS_CPU_A.S
   Uses
      At line 306 in file ucos_ii\src\OS_CPU_A.S
Comment: marsIntIRQHandler used once
15 symbols
428 symbols in table
